<div class="search-box">
  <label>
    <span>搜尋檔案標籤</span>
    <input type="text" [(ngModel)]="keyword" (ngModelChange)="onKeywordChange()" pInputText>
  </label>
</div>

<div class="file-table">
  <p-table [value]="filtedSoundList" [paginator]="true" [rows]="10" [pageLinks]="10">
    <ng-template pTemplate="header">
      <tr>
        <th>檔名</th>
        <th [pSortableColumn]="'server_modified'">
          <span>最後修改時間</span>
          <p-sortIcon [field]="'server_modified'"></p-sortIcon>
        </th>
        <th>標籤</th>
        <th>下載</th>
        <th>音源預覽</th>
      </tr>
    </ng-template>
    <ng-template pTemplate="body" let-sound>
      <tr>
        <td [style.max-width]="'240px'" [style.min-width]="'240px'">{{sound.name}}</td>
        <td [style.max-width]="'136px'" [style.min-width]="'136px'">{{showDatetime(sound.modifyDatetime) | slice:0:10}}</td>
        <td>
          <app-tag-autocomplete [(ngModel)]="sound.tagsClouds" [suggestions]="filtedTagList" (completeMethod)="filterTag($event)" placeholder="tag" [multiple]="true" (onSelect)="onTagsAdd(sound)" (onUnselect)="onTagsRemove($event, sound)" [inputStyle]="{'width': '100%'}">
          </app-tag-autocomplete>
        </td>
        <td [style.max-width]="'88px'" [style.min-width]="'88px'">
          <button (click)="onDownloadClick(sound.url)" type="button" pButton label="下載"></button>
        </td>
        <td [style.max-width]="'480px'" [style.min-width]="'480px'">
          <img *ngIf="sound.graph" [src]="safeResource(sound.graph)">
          <button *ngIf="!sound.graph" (click)="updateVoiceGraph($event, sound)" type="button" pButton label="更新音波圖"></button>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>

<div id="waveform"></div>
